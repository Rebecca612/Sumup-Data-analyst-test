create or replace view STG_CHANNELS(
	CAMPAIGN_ID,
	CAMPAIGN_NAME,
	CAMPAIGN_BUDGET_CATEGORY,
	CHANNEL_3,
	CHANNEL_4,
	CHANNEL_5
) as

SELECT
    CAMPAIGN_ID,
    CAMPAIGN_NAME,
    CAMPAIGN_BUDGET_CATEGORY,
    CHANNEL_3,
    CHANNEL_4,
    CHANNEL_5
FROM (

    SELECT
        CAST(CAMPAIGN_ID AS NUMBER(38,0)) AS CAMPAIGN_ID,
        NULLIF(TRIM(CAMPAIGN_NAME), '') AS CAMPAIGN_NAME,
        NULLIF(TRIM(LOWER(CAMPAIGN_PERIOD_BUDGET_CATEGORY)), '') 
            AS CAMPAIGN_BUDGET_CATEGORY,
        NULLIF(TRIM(LOWER(CHANNEL_3)), '') AS CHANNEL_3,
        NULLIF(TRIM(LOWER(CHANNEL_4)), '') AS CHANNEL_4,
        NULLIF(TRIM(LOWER(CHANNEL_5)), '') AS CHANNEL_5,

        ROW_NUMBER() OVER (
            PARTITION BY CAST(CAMPAIGN_ID AS NUMBER(38,0))
            ORDER BY CAMPAIGN_NAME
        ) AS rn

    FROM channels

)

WHERE rn = 1;
